include pug/message

// -var msg = dataObj
doctype html
html(lang='en')
    head
        meta(charset='UTF-8')
        meta(name='viewport', content="width=device-width, initial-scale=1.0")
        title Чат
        link(href='style.css' rel='stylesheet')
        //link(rel='preconnect' href='https://fonts.gstatic.com')
        //link(rel='stylesheet' href='https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@1,300&display=swap')
        link(rel='preconnect' href='https://fonts.gstatic.com')
        link(href='https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400&display=swap' rel='stylesheet')
        script(src='https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js' type='text/javascript')
        script(src='https://www.gstatic.com/firebasejs/8.3.0/firebase-app.js' type='text/javascript')
        script(src='https://www.gstatic.com/firebasejs/8.3.0/firebase-auth.js' type='text/javascript')
        script(src='https://www.gstatic.com/firebasejs/8.3.0/firebase-database.js' type='text/javascript')
        script(src='https://www.gstatic.com/firebasejs/8.3.0/firebase-firestore.js' type='text/javascript')
        script(src='js/index.js' type='module')
        script(src='js/view.js' type='module')
        script(src='js/controller.js' type='module')
        script(src='js/model.js' type='module')


    body
        main.chat
            //main.chat.overlay
            include pug/auth
            include pug/photo
            include pug/menu

            aside.chat__panel

                .chat__row
                    button.btn._menu.js-menu-btn(data-action='true')
                        span
                        span
                        span
                    input.chat__search(placeholder="Найти...")
                #users.chat__users
                    script(id="usersTemplate" type="text/x-handlebars-template")
                        div.
                            {{#each list}}
                                {{#if id}}
                                    <div class="message _active">
                                    {{else}}
                                    <div class="message">
                                {{/if}}

                                    {{#if ava }}
                                        <img src={{ava}} class="message__ava" />
                                        {{else}}
                                        <span class="message__ava-name" title="{{name}}">{{name.[0]}}</span>
                                    {{/if}}

                                    <div class="message__block">
                                    <div class="message__name">{{name}}</div>
                                </div>
                            {{/each}}
            .chat__content
                .chat__name чат
                    span.js-users-quantity Участников:
                .chat__history.scroll
                    #results

                    script(id="messagesTemplate" type="text/x-handlebars-template")
                        div.
                            {{#each list}}
                                {{#if id}}
                                    <div class="message _my">
                                    {{else}}
                                    <div class="message">
                                {{/if}}

                                    {{#if ava }}
                                        <img src={{ava}} class="message__ava" />
                                        {{else}}
                                        <span class="message__ava-name" title="{{name}}">{{name.[0]}}</span>
                                    {{/if}}

                                    <div class="message__block">
                                    <div class="message__name">{{name}}</div>
                                            {{#each messages}}
                                                <div class="message__text"> <div>{{{this.[0]}}} </div> <span>{{this.[1]}} </span></div>
                                            {{/each}}
                                    </div>
                                </div>
                            {{/each}}
                //+message('./img/ava.jpg', [
                    //    {text: 'Привет!', time: '17:55'},
                    //    {text: 'Как дела?', time: '17:55'}
                    //], false)

                form.form.chat__send.js-form-send(data-action='true')
                    textarea(row="1" wrap="hard" placeholder="Введите сообщение...").scroll.js-text
                    span.chat__help shift + enter
                    button.btn._size-small.js-send
                        span Отправить
                        include img/send.svg